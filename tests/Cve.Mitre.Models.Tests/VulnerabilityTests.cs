using Xunit;

namespace Cve.Mitre.Models.Tests;

public class VulnerabilityTests
{
    [Fact]
    public void ShouldContainValidUri()
    {
        const string expectedUri = "https://cve.mitre.org/cgi-bin/cvename.cgi?name=test";
        
        var vulnerability = new Vulnerability()
        {
            CveId = "test",
            Description = "Test Description"
        };
        
        Assert.NotNull(vulnerability.Link);
        Assert.Equal(expectedUri, vulnerability.Link!.AbsoluteUri);
    }

    [Fact]
    public void ShouldContainNullUri()
    {
        var vulnerability = new Vulnerability
        {
            CveId = "",
            Description = "Test Description"
        };
        
        Assert.Null(vulnerability.Link);
    }
}